from web3 import Web3
import json

url = "https://blockchain-solveme-bade5bce98cd8b12-eth.2022.ductf.dev/"
provider = Web3(Web3.HTTPProvider(url))
print("Is connected? ", provider.isConnected())
privateKey = '0x5b86de9174316857cee939f8e92c04914205e8447abe00bff3868b4dee103713'
nonce = 0

with open("solveMe.json") as f:       #json file with the contract ABI
    solveMe_json = json.load(f)

solveMeContract = Web3.toChecksumAddress('0x6E4198C61C75D1B4D1cbcd00707aAC7d76867cF8')
solveMe = provider.eth.contract(address=solveMeContract, abi = solveMe_json)

print("è risolta: ", solveMe.functions.isSolved().call())


transaction = solveMe.functions.solveChallenge().buildTransaction({
    'gas': 70000,
    'gasPrice': Web3.toWei(40, 'gwei'), 
    'nonce': nonce
})      #Withdraw all the token to the sender address
signed_txn = provider.eth.account.signTransaction(transaction, private_key=privateKey)
provider.eth.sendRawTransaction(signed_txn.rawTransaction)

print("è risolta: ", solveMe.functions.isSolved().call())
